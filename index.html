<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>확률과 통계 수업 대시보드</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NK7JXGN417"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-NK7JXGN417');
  </script>
  <style>
    /* 폰트: 한국어 가독성 강화 */
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;800&family=Inter:wght@500;600;700;800;900&display=swap');

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      font-family: 'Noto Sans KR','Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:#1f2937;
      font-size:16px; line-height:1.8; letter-spacing:-.01em;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      min-height:100vh;
    }

    h1,h2,h3,h4{line-height:1.35;margin-bottom:.5rem;font-weight:800}
    h1{font-size:2rem} h2{font-size:1.5rem} h3{font-size:1.25rem} h4{font-size:1.125rem}

    /* 헤더 */
    .header-gradient{
      background:linear-gradient(135deg,#3182ce 0%,#805ad5 100%);
      box-shadow:0 12px 28px rgba(79,70,229,.25);
      border-radius:14px; color:white;
    }

    /* 액션 타일 */
    .action-tile{
      border-radius:16px; padding:24px; color:#fff; width:100%;
      box-shadow:0 10px 28px rgba(0,0,0,.18);
      transition:transform .18s ease, box-shadow .18s ease, filter .18s ease;
      position:relative; overflow:hidden; text-align:center; cursor:pointer; border:0;
    }
    .action-tile:hover{transform:translateY(-4px); box-shadow:0 18px 36px rgba(0,0,0,.22); filter:brightness(1.03)}
    .tile-blue{background:linear-gradient(135deg,#3b82f6 0%,#6366f1 100%)}
    .tile-green{background:linear-gradient(135deg,#22c55e 0%,#3b82f6 100%)}
    .tile-purple{background:linear-gradient(135deg,#8b5cf6 0%,#a855f7 100%)}
    .tile-orange{background:linear-gradient(135deg,#f59e0b 0%,#f97316 100%)}

    /* 카드 공통 */
    .card{
      background:#ffffff; border-radius:16px; padding:24px;
      box-shadow:0 6px 20px rgba(0,0,0,.08);
      border:1px solid rgba(0,0,0,.05);
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .card:hover{transform:translateY(-3px); box-shadow:0 12px 28px rgba(0,0,0,.12)}

    /* 검색바 */
    .search-container{
      background:#fff; border-radius:9999px; padding:10px 14px;
      box-shadow:0 6px 20px rgba(0,0,0,.10);
      transition:box-shadow .18s ease, transform .18s ease;
    }
    .search-container:focus-within{transform:translateY(-1px); box-shadow:0 10px 28px rgba(0,0,0,.14)}
    .search-input{border:none; outline:none; width:100%; background:transparent; font-size:16px; color:inherit}
    .search-input::placeholder{color:#9aa3af}

    /* 다크모드 스타일 */
    body.dark {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #e5e7eb;
    }
    
    body.dark .card {
      background: #1f2937;
      border-color: rgba(255,255,255,.1);
      color: #e5e7eb;
    }
    
    body.dark .search-container {
      background: #1f2937;
      color: #e5e7eb;
    }
    
    body.dark .search-input::placeholder {
      color: #9ca3af;
    }
    
    body.dark .iframe-modal {
      background: #1f2937;
      color: #e5e7eb;
    }
    
    body.dark .iframe-header {
      border-bottom-color: #374151;
    }
    
    /* 테마 토글 버튼 */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 999;
      background: rgba(255,255,255,0.9);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    
    .theme-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }
    
    body.dark .theme-toggle {
      background: rgba(31,41,55,0.9);
      color: #e5e7eb;
    }

    /* ===== 인-모드 iframe 모달 =====
       깜빡임 방지: display 고정, visibility/opacity 전환 + 스크롤 잠금시 padding-right 보정 */
    .iframe-container{
      position: fixed; inset: 0; z-index: 1000;
      background: rgba(0,0,0,0.6);
      padding: 24px;
      display: block;             /* 항상 DOM 상주 */
      visibility: hidden;         /* 보이기/숨김만 토글 */
      opacity: 0;
      transition: opacity .25s ease, visibility .25s ease;
    }
    .iframe-container.is-open{
      visibility: visible;
      opacity: 1;
    }
    .iframe-modal{
      background:#fff; color:#111827; border-radius:14px;
      box-shadow:0 25px 70px rgba(0,0,0,.3);
      width:100%; height:100%;
      display:flex; flex-direction:column;
    }
    .iframe-header{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px; border-bottom:1px solid #e5e7eb;
    }
    .iframe-title{font-weight:800; font-size:18px; margin:0;}
    .iframe-actions{display:flex; gap:8px; align-items:center;}
    .btn-primary{
      background:#4f46e5; color:#fff; border:none; border-radius:8px;
      padding:8px 12px; font-weight:700; cursor:pointer;
    }
    .btn-primary:hover{filter:brightness(1.05)}
    .btn-close{
      border:none; background:transparent; font-size:28px; line-height:1; cursor:pointer; color:#6b7280;
    }
    .btn-close:hover{ color:#111827; }
    .iframe-body{flex:1;}
    .iframe-body iframe{width:100%; height:100%; border:0; border-radius:0 0 14px 14px;}

    /* 모션 감소 선호 */
    @media (prefers-reduced-motion: reduce){
      .iframe-container{transition:none}
      .search-container{transition:none}
      .action-tile{transition:none}
      .card{transition:none}
    }
  </style>
</head>
<body>

  <!-- 다크모드 토글 버튼 -->
  <button id="themeToggle" class="theme-toggle" aria-label="테마 변경">
    🌙
  </button>

  <div class="max-w-7xl mx-auto p-6">
    <!-- 헤더 -->
    <header class="header-gradient p-8 mb-8">
      <div class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6">
        <div>
          <h1 class="text-3xl font-extrabold">확률과 통계 수업</h1>
          <p class="text-indigo-100 font-semibold mt-1">2025년 2학기 • 담당: 박도영</p>
          <div class="mt-4 flex items-center gap-2 text-sm">
            <span class="bg-white/20 px-3 py-1 rounded-full">📚 수학</span>
            <span class="bg-white/20 px-3 py-1 rounded-full">⏰ 3시간</span>
            <span class="bg-white/20 px-3 py-1 rounded-full">🏫 2-6교실</span>
          </div>
        </div>
        
        <!-- 전체 시간표 보기 버튼 -->
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20">
          <div class="text-center">
            <button onclick="handleViewSchedule()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors font-semibold">
              📅 전체 시간표 보기 →
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- 검색 -->
    <div class="search-container mb-6">
      <div class="flex items-center gap-2">
        <i data-lucide="search" class="w-5 h-5 text-gray-400"></i>
        <input id="searchInput" type="text" class="search-input" placeholder="수업 내용, 시험 정보, 공지사항 등을 검색해보세요..." />
      </div>
    </div>

    <!-- 액션 버튼 (인-모드로 열고, 모달 상단에 '새 창으로 열기' 있음) -->
    <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto searchable" data-search-text="OT 자료 자기평가 평균맞히기 큰수의법칙 실험기 동전던지기 시뮬레이션">


      <button class="action-tile tile-blue" onclick="handleViewOTMaterial()" aria-label="OT 자료 열기">
        <div class="text-3xl mb-2">📚</div>
        <h3 class="text-xl font-extrabold">OT 자료</h3>
        <p class="opacity-90">수업 소개 및 규칙</p>
      </button>

      <button class="action-tile tile-purple" onclick="handleViewSelfEvaluation()" aria-label="자기평가 결과 열기">
        <div class="text-3xl mb-2">📊</div>
        <h3 class="text-xl font-extrabold">자기평가 결과</h3>
        <p class="opacity-90">1학기 학생 의견 분석</p>
      </button>

      <button class="action-tile tile-orange" onclick="handleViewGameResult()" aria-label="평균 맞히기 게임 결과 열기">
        <div class="text-3xl mb-2">🎯</div>
        <h3 class="text-xl font-extrabold">평균 맞히기 게임</h3>
        <p class="opacity-90">통계적 추정 능력 측정</p>
      </button>

      <button class="action-tile tile-green" onclick="handleViewLawOfLargeNumbers()" aria-label="큰수의 법칙 실험기 열기">
        <div class="text-3xl mb-2">🔢</div>
        <h3 class="text-xl font-extrabold">큰수의 법칙 실험기</h3>
        <p class="opacity-90">동전 던지기 시뮬레이션</p>
      </button>
    </section>

    <!-- 평가 방법 -->
    <section class="card mt-6 searchable" data-search-text="평가 방법 중간고사 기말고사 수행평가 과정평가 탐구발표">
      <h3 class="text-2xl font-extrabold flex items-center gap-2 mb-4">
        <i data-lucide="clipboard-list" class="w-6 h-6"></i> 📊 평가 방법
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="text-center p-5 rounded-xl border bg-blue-50/70 border-blue-200">
          <div class="text-3xl mb-2">📝</div>
          <h4 class="font-bold text-blue-800 mb-1">중간고사</h4>
          <p class="text-blue-700 text-lg font-extrabold">30%</p>
          <p class="text-blue-600 text-sm mt-1">9월 25일~10월 2일</p>
        </div>

        <div class="text-center p-5 rounded-xl border bg-green-50/70 border-green-200">
          <div class="text-3xl mb-2">📝</div>
          <h4 class="font-bold text-green-800 mb-1">기말고사</h4>
          <p class="text-green-700 text-lg font-extrabold">30%</p>
          <p class="text-green-600 text-sm mt-1">12월 11일~17일</p>
        </div>

        <div class="text-center p-5 rounded-xl border bg-purple-50/70 border-purple-200 md:col-span-2 lg:col-span-1">
          <div class="text-3xl mb-2">🎯</div>
          <h4 class="font-bold text-purple-800 mb-1">수행평가</h4>
          <p class="text-purple-700 text-lg font-extrabold">40%</p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
            <div class="rounded-lg p-3 bg-white/60">
              <p class="font-semibold text-purple-700">📋 단계별 과정평가</p>
              <p class="text-purple-600 text-sm">과정평가 1, 2 (30%)</p>
            </div>
            <div class="rounded-lg p-3 bg-white/60">
              <p class="font-semibold text-purple-700">🎤 주제탐구발표</p>
              <p class="text-purple-600 text-sm">자료 제출 (10%)</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 시험 정보 -->
    <section class="card mt-6 searchable" data-search-text="시험 정보 중간고사 기말고사 시험 기간 범위 통계적 추정 확률분포">
      <h3 class="text-2xl font-extrabold flex items-center gap-2 mb-4">
        <i data-lucide="calendar-days" class="w-6 h-6"></i> 📅 시험 정보
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="rounded-xl border p-6 bg-blue-50/70 border-blue-200">
          <h4 class="text-xl font-extrabold text-blue-800 mb-3 flex items-center gap-2">
            <i data-lucide="calendar" class="w-5 h-5"></i> 중간고사
          </h4>
          <ul class="space-y-2 text-blue-900">
            <li class="flex justify-between"><span class="font-semibold">시험 기간</span><span>9월 25일 ~ 10월 2일</span></li>
            <li class="flex justify-between"><span class="font-semibold">시험 시간</span><span>50분</span></li>
            <li class="flex justify-between"><span class="font-semibold">시험 범위</span><span>Ⅲ-1. 확률분포</span></li>
          </ul>
        </div>

        <div class="rounded-xl border p-6 bg-green-50/70 border-green-200">
          <h4 class="text-xl font-extrabold text-green-800 mb-3 flex items-center gap-2">
            <i data-lucide="calendar" class="w-5 h-5"></i> 기말고사
          </h4>
          <ul class="space-y-2 text-green-900">
            <li class="flex justify-between"><span class="font-semibold">시험 기간</span><span>12월 11일 ~ 17일</span></li>
            <li class="flex justify-between"><span class="font-semibold">시험 시간</span><span>50분</span></li>
            <li class="flex justify-between"><span class="font-semibold">시험 범위</span><span>Ⅲ-1. 확률분포+ Ⅲ-2. 통계적 추정</span></li>
            <li class="flex justify-between"><span class="font-semibold">특이사항</span><span>평가원 기출문제 포함</span></li>
          </ul>
        </div>
      </div>
    </section>

    <!-- 공지사항 -->
    <section class="card mt-6 searchable" data-search-text="공지 교재 준비 수행평가 발표 권장 수능 출제 비중 안내">
      <h3 class="text-2xl font-extrabold flex items-center gap-2 mb-4">
        <i data-lucide="megaphone" class="w-6 h-6"></i> 📢 공지사항
      </h3>

      <div class="space-y-4">
        <article class="border-l-4 border-blue-500 pl-4 py-2">
          <div class="flex items-center justify-between">
            <h4 class="font-bold">📚 교재 준비 안내</h4>
          </div>
          <p class="text-gray-700 mt-1">주교재: 확률과 통계 (금성출판사), 부교재: EBS 수능특강 확률과 통계</p>
        </article>

        <article class="border-l-4 border-green-500 pl-4 py-2">
          <div class="flex items-center justify-between">
            <h4 class="font-bold">🎯 수행평가 안내</h4>
          </div>
          <p class="text-gray-700 mt-1">주제탐구발표 자료 제출: 한글 파일 2쪽 이상, 제출기한 초과 시 1일당 2점 감점</p>
        </article>

        <article class="border-l-4 border-purple-500 pl-4 py-2">
          <div class="flex items-center justify-between">
            <h4 class="font-bold">🏆 발표 권장사항</h4>
          </div>
          <p class="text-gray-700 mt-1">교과서 문제 풀이, 증명 발표 시 세특 기재 가능 (필수는 아님, 적극 권장)</p>
        </article>

        <article class="border-l-4 border-orange-500 pl-4 py-2">
          <div class="flex items-center justify-between">
            <h4 class="font-bold">📊 수능 출제 비중</h4>
          </div>
          <p class="text-gray-700 mt-1">공통과목 22문항(74점), 선택과목 8문항(26점) - 확률과 통계/미적분/기하 중 선택</p>
        </article>
      </div>
    </section>
  </div>

  <!-- 인-모드 iframe 모달 -->
  <div id="iframeContainer" class="iframe-container" aria-hidden="true">
    <div class="iframe-modal">
      <div class="iframe-header">
        <h2 id="iframeTitle" class="iframe-title">문서</h2>
        <div class="iframe-actions">
          <button type="button" id="openNewTabBtn" class="btn-primary">새 창으로 열기</button>
          <button type="button" id="closeIframeBtn" class="btn-close" aria-label="닫기">&times;</button>
        </div>
      </div>
      <div class="iframe-body">
        <iframe id="contentFrame" title="내장 문서 뷰어" allow="clipboard-read; clipboard-write" referrerpolicy="no-referrer"></iframe>
      </div>
    </div>
  </div>

  <script>
    // 아이콘 1회 초기화
    lucide.createIcons();

    // 다크모드 토글
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    
    // 저장된 테마 불러오기
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
      body.classList.add('dark');
      themeToggle.textContent = '☀️';
    }
    
    // 테마 토글 함수
    function toggleTheme() {
      body.classList.toggle('dark');
      const isDark = body.classList.contains('dark');
      
      if (isDark) {
        themeToggle.textContent = '☀️';
        localStorage.setItem('theme', 'dark');
      } else {
        themeToggle.textContent = '🌙';
        localStorage.setItem('theme', 'light');
      }
    }
    
    themeToggle.addEventListener('click', toggleTheme);

    // 검색: 섹션 단위 필터링
    const searchInput = document.getElementById('searchInput');
    const searchable = Array.from(document.querySelectorAll('.searchable'));
    searchInput.addEventListener('input', function(){
      const q = this.value.trim().toLowerCase();
      searchable.forEach(sec => {
        const hay = (sec.getAttribute('data-search-text') || sec.textContent || '').toLowerCase();
        sec.classList.toggle('hidden', q && !hay.includes(q));
      });
    });

    // ===== 모달 요소 =====
    const iframeContainer = document.getElementById('iframeContainer');
    const iframeEl = document.getElementById('contentFrame');
    const iframeTitle = document.getElementById('iframeTitle');
    const closeBtn = document.getElementById('closeIframeBtn');
    const openNewTabBtn = document.getElementById('openNewTabBtn');

    // 스크롤바 폭 측정 (레이아웃 점프 방지)
    function getScrollbarWidth(){
      const outer = document.createElement('div');
      outer.style.visibility = 'hidden';
      outer.style.overflow = 'scroll';
      outer.style.width = '100px';
      document.body.appendChild(outer);
      const inner = document.createElement('div');
      inner.style.width = '100%';
      outer.appendChild(inner);
      const w = outer.offsetWidth - inner.offsetWidth;
      outer.remove();
      return w;
    }

    // 모달 열기 (인-모드)
    function showInIframe(url, title){
      const sbw = getScrollbarWidth();
      document.documentElement.style.overflow = 'hidden';
      if (sbw) document.body.style.paddingRight = `${sbw}px`;

      iframeTitle.textContent = title || '문서';
      iframeEl.src = url;

      iframeContainer.classList.add('is-open');
      iframeContainer.setAttribute('aria-hidden','false');

      setTimeout(()=> closeBtn && closeBtn.focus(), 0);
    }

    // 모달 닫기
    function closeIframe(){
      iframeContainer.classList.remove('is-open');
      iframeContainer.setAttribute('aria-hidden','true');
      iframeEl.src = ''; // 로딩/오디오 등 중단

      document.documentElement.style.overflow = '';
      document.body.style.paddingRight = '';
    }

    // 새 창으로 열기
    function openInNewTab(){
      if (iframeEl && iframeEl.src) {
        window.open(iframeEl.src, '_blank', 'noopener');
      }
    }

    // 이벤트 바인딩
    iframeContainer.addEventListener('click', (e)=>{
      if(e.target === iframeContainer){ closeIframe(); }
    });
    closeBtn.addEventListener('click', closeIframe);
    openNewTabBtn.addEventListener('click', openInNewTab);
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape' && iframeContainer.classList.contains('is-open')) closeIframe();
    });

    // 버튼 핸들러 (인-모드로 먼저 열기)
    function handleViewOTMaterial(){ showInIframe('./orientation.html', 'OT 자료'); }
    function handleViewSchedule(){ showInIframe('./schedule.html', '선생님 시간표'); }
    function handleViewSelfEvaluation(){ showInIframe('./self-evaluation.html', '자기평가 결과'); }
    function handleViewGameResult(){ showInIframe('./average-game-result.html', '평균 맞히기 게임 결과'); }
    function handleViewLawOfLargeNumbers(){ showInIframe('./law-of-large-numbers.html', '큰수의 법칙 실험기'); }
    

    // 전역 노출 (onclick용)
    window.handleViewOTMaterial = handleViewOTMaterial;
    window.handleViewSchedule = handleViewSchedule;
    window.handleViewSelfEvaluation = handleViewSelfEvaluation;
    window.handleViewGameResult = handleViewGameResult;
    window.handleViewLawOfLargeNumbers = handleViewLawOfLargeNumbers;
  </script>
</body>
</html>
