<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>큰수의 법칙 실험기 - 주사위</title>
  <link rel="stylesheet" href="common-styles.css">
  <!-- Chart.js 먼저 로드 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- MathJax 설정 -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        packages: ['base', 'ams', 'noerrors', 'noundefined']
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      },
      startup: {
        pageReady: () => {
          return MathJax.startup.defaultPageReady().then(() => {
            console.log('MathJax 초기화 완료');
            // MathJax 렌더링 완료 후 그래프 그리기
            if (typeof Chart !== 'undefined') {
              setTimeout(() => {
                if (typeof drawTheoryChart === 'function') {
                  drawTheoryChart();
                }
              }, 200);
            }
          });
        }
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    .lln-tabs { margin-top: 16px; }
    .lln-tab-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
    .lln-tab-btn { padding: 6px 12px; border: 1px solid #d0d7de; background: #f6f8fa; border-radius: 6px; cursor: pointer; }
    .lln-tab-btn.active { background: #0d6efd; color: #fff; border-color: #0d6efd; }
    .lln-tab-pane { display: none; margin-top: 12px; }
    .lln-tab-pane.active { display: block; }
  </style>
  
  <!-- MathJax 로딩 확인 스크립트 -->
  <script>
    function checkMathJax() {
      if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
        console.log('MathJax 완전 로드됨');
        // 페이지의 모든 수식 렌더링
        MathJax.typesetPromise().then(() => {
          console.log('MathJax 초기 렌더링 완료');
        });
      } else {
        console.log('MathJax 아직 로딩 중...');
        setTimeout(checkMathJax, 100);
      }
    }
    
    // 페이지 로드 후 MathJax 확인
    window.addEventListener('load', checkMathJax);
  </script>
</head>
<body>
  <div class="container">
    <h1>🎲 큰수의 법칙 실험기 - 주사위</h1>
    
    <!-- 이론적 확률분포 결과 -->
    <div class="theory-section">
      <h2>📊 이론적 확률분포 결과</h2>
      <p>
        주사위를 \(n\)번 던질 때 3의 눈이 나오는 횟수를 \(X\)라고 할 때, 
        \(n=10, 20, 30, 40, 50\)일 때의 확률분포:
      </p>
      
      <div class="theory-chart">
        <canvas id="theoryChart" width="800" height="400" style="max-height: 400px; width: 100%;"></canvas>
      </div>
      
      <div class="theory-table">
        <table>
          <thead>
            <tr>
              <th>\(n\) (던진 횟수)</th>
              <th>\(X\) (3의 눈 횟수)</th>
              <th>\(P(|\frac{X}{n} - \frac{1}{6}| < 0.1)\)</th>
            </tr>
          </thead>
          <tbody id="theoryTableBody">
            <!-- JS에서 정확한 값으로 동적 채움 -->
          </tbody>
        </table>
      </div>
      
    </div>

    <div class="experiment-section">
      <h2>🔬 실험 프로그램</h2>
      
      <!-- 매개변수 설명 -->
      <div class="parameter-explanation">
        <h3> 매개변수 설명</h3>
        <ul>
          <li><strong>n (던진 횟수):</strong> 주사위를 던지는 횟수. 클수록 수학적 확률에 가까워집니다.</li>
          <li><strong>h (허용 오차):</strong> 상대도수가 수학적 확률에서 벗어날 수 있는 허용 범위</li>
          <li><strong>repeat (반복 횟수):</strong> 전체 실험을 반복하는 횟수. 클수록 안정적인 결과</li>
        </ul>
      </div>
      
      <p>
        <strong>실험 설명:</strong> 주사위를 \(n\)번 던져서 3의 눈이 나오는 횟수 \(X\)를 구하고, 
        상대도수 \(\frac{X}{n}\)이 수학적 확률 \(\frac{1}{6}\)에 수렴하는지 확인합니다.
      </p>
      <p>
        사용자가 설정한 오차 범위 \(h\) 안에 들어오는 비율을 계산하여 
        <strong>큰수의 법칙</strong>을 체험할 수 있습니다.
      </p>

      <div class="controls">
        <label>던진 횟수 \(n\): <input type="number" id="n" value="50" min="10" max="1000"></label>
        <label>허용 오차 \(h\): <input type="number" step="0.01" id="h" value="0.1" min="0.01" max="0.5"></label>
        <label>반복 횟수 repeat: <input type="number" id="repeat" value="1000" min="100" max="10000"></label>
        <button onclick="runSimulation()">실험 시작</button>
      </div>

      <div id="result" class="result-display"></div>
      <canvas id="chart" width="800" height="400" style="max-height: 400px; width: 100%;"></canvas>
      
      <div class="experiment-explanation">
        <h3>🎯 실험 결과 해석</h3>
        <p>
          <strong>이론적 기댓값:</strong> \(E\left[\frac{X}{n}\right] = \frac{1}{6} \approx 0.1667\)
        </p>
        <p>
          <strong>이론적 분산:</strong> \(V\left[\frac{X}{n}\right] = \frac{1}{n} \cdot \frac{1}{6} \cdot \frac{5}{6} = \frac{5}{36n}\)
        </p>

      </div>
    </div>
  </div>
  <div class="container">
    <div class="lln-tabs">
      <h2>🧠 학습 정리</h2>
      <div class="lln-tab-buttons">
        <button type="button" class="lln-tab-btn active" data-target="lln-tab-definition">수학적 정의</button>
        <button type="button" class="lln-tab-btn" data-target="lln-tab-significance">의의</button>
      </div>
      <div id="lln-tab-definition" class="lln-tab-pane active">
        <h3>📚 수학적 정의</h3>
        <p>
          <strong>큰수의 법칙:</strong> 주사위를 \(n\)번 던질 때 3의 눈이 나오는 횟수를 \(X\)라고 하면,
          이항분포 \(B(n, \frac{1}{6})\)를 따릅니다.
        </p>
        <p>
          <strong>약한 큰수의 법칙(WLLN):</strong> 지시확률변수 \(I_i=\mathbf{1}_{\{i\text{번째 시행에서 3}\}}\)에 대해
          표본평균 \(\overline{X}_n = \frac{1}{n}\sum_{i=1}^n I_i = \frac{X}{n}\)이라 두면, 모든 \(\varepsilon>0\)에 대하여
          \[\lim_{n\to\infty} \Pr\big(|\overline{X}_n-\tfrac{1}{6}|<\varepsilon\big)=1,\]
          즉 \(\overline{X}_n=\tfrac{X}{n}\)이 \(\tfrac{1}{6}\)에 <em>확률수렴</em>합니다.
        </p>
      </div>
      <div id="lln-tab-significance" class="lln-tab-pane">
        <h3>✨ 의의</h3>
        <p>
          시행 횟수 \(n\)이 충분히 클 때, 상대도수 \(\frac{X}{n}\)은 수학적 확률에 가까워지므로 임의의 사건 \(A\)에 대해
          상대도수 \(\frac{X}{n}\)를 사건 \(A\)가 일어날 확률 \(P(A)\)로 쓸 수 있습니다. 따라서 자연 현상이나 사회 현상처럼
          수학적 확률을 직접 구하기 곤란한 경우에는 시행 횟수를 충분히 크게 한 후 통계적 확률을 이용할 수 있습니다.
        </p>
      </div>
    </div>
  </div>
  <script src="law-of-large-numbers.js?v=2"></script>
</body>
</html>
